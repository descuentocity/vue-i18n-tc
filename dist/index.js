"use strict";function getLocale(e,t){void 0===t&&(t="");var r=e[t];return r||t}function interpolateArray(e,t){void 0===t&&(t=[]);var r=e;return t.forEach(function(e){r=r.replace(/\?/,e)}),r}function interpolateObject(e,t){var r=e;return e.match(/\{[\w]+\}/g).forEach(function(e){var n=e.replace(/\{?\}?/g,""),o=new RegExp(e,"g");r=r.replace(o,t[n])}),r}function pluralization(e,t){var r=e.split("|");return t>1&&r[1]?r[1]:r[0]}function localize(e,t,r,n){try{var o=getLocale(e,t);return n?o=pluralization(o,n):"number"==typeof r&&(o=pluralization(o,r)),Array.isArray(r)?interpolateArray(o,r):"object"==typeof r?interpolateObject(o,r):o}catch(e){return console.error(e),t}}function getLocales(e){var t=e.path,r=e.get;return new Promise(function(e){if(r)return void r().then(function(t){e(t)}).catch(function(t){console.error(t),e({})});ajax({path:t}).promise.then(function(t){e(t)}).catch(function(t){console.error(t),e({})})})}var ajax=function(e){var t=e.path,r=e.method;void 0===r&&(r="GET");var n=new XMLHttpRequest;n.open(r,t,!0);var o=function(){},a={promise:new Promise(function(e,t){n.onload=function(){if(n.status>=200&&n.status<400){var r;try{r=JSON.parse(n.responseText)}catch(t){e(n.responseText)}e(r)}else t(n.responseText)},o=function(){n.abort(),t("Cancelled")},n.onerror=t})};return a.cancel=o,n.send(),a},LocalesLoader=function(e){var t=this,r=(e.SSR,e.path),n=e.get,o=e.locales;this.locales=void 0,this.observers=[],getLocales({path:r,get:n,locales:o}).then(function(e){t.locales=e,t.observers.map(function(t){return t(e)})}).catch(function(e){console.error(e)})};LocalesLoader.prototype.subscribe=function(e){if(this.locales)return void e(this.locales);this.observers=this.observers||[],this.observers.push(e)};var index={install:function(e,t){var r=t.lang,n=t.SSR,o=t.path,a=t.get,c=t.locales;if(c)return void e.mixin({data:function(){return{lang:r,locales:c}},methods:{__:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return localize.apply(void 0,[this.locales].concat(e))}}});var i=new LocalesLoader({lang:r,SSR:n,path:o,get:a});e.mixin({data:function(){return{lang:r,locales:{}}},created:function(){var e=this;i.subscribe(function(t){e.locales=t})},methods:{__:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return localize.apply(void 0,[this.locales].concat(e))}}})}};module.exports=index;
