"use strict";function getLocale(e,r){void 0===r&&(r="");var t=e[r];return t||r}function interpolateArray(e,r){void 0===r&&(r=[]);var t=e;return r.forEach(function(e){t=t.replace(/\?/,e)}),t}function interpolateObject(e,r){var t=e;return e.match(/\{[\w]+\}/g).forEach(function(e){var n=e.replace(/\{?\}?/g,""),o=new RegExp(e,"g");t=t.replace(o,r[n])}),t}function pluralization(e,r){var t=e.split("|");return r>1&&t[1]?t[1]:t[0]}function localize(e,r,t,n){try{var o=getLocale(e,r);return n?o=pluralization(o,n):"number"==typeof t&&(o=pluralization(o,t)),Array.isArray(t)?interpolateArray(o,t):"object"==typeof t?interpolateObject(o,t):o}catch(e){return console.error(e),r}}var ajax=function(e){var r=e.path,t=e.method;void 0===t&&(t="GET");var n=new XMLHttpRequest;n.open(t,r,!0);var o=function(){},a={promise:new Promise(function(e,r){n.onload=function(){if(n.status>=200&&n.status<400){var t;try{t=JSON.parse(n.responseText)}catch(r){e(n.responseText)}e(t)}else r(n.responseText)},o=function(){n.abort(),r("Cancelled")},n.onerror=r})};return a.cancel=o,n.send(),a},LocalesLoader=function(e){var r=this,t=e.lang,n=e.SSR,o=e.path,a=e.get;if(this.locales={},this.observers={},a)return void a().then(function(e){r.locales[t]=e,r.observers[t].map(function(r){return r(e)})}).catch(function(e){console.error(e)});if(n){var i=require(o);return this.locales[t]=i,void this.observers[t].map(function(e){return e(i)})}ajax({path:o}).promise.then(function(e){r.locales[t]=e,r.observers[t].map(function(r){return r(e)})}).catch(function(e){console.error(e)})};LocalesLoader.prototype.subscribe=function(e,r){if(this.locales[e])return void r(this.locales[e]);this.observers[e]=this.observers[e]||[],this.observers[e].push(r)},module.exports={install:function(e,r){var t=r.lang,n=r.SSR,o=r.path,a=r.get,i=new LocalesLoader({lang:t,SSR:n,path:o,get:a});e.mixin({data:function(){return{lang:t,locales:{}}},created:function(){var e=this;i.subscribe(t,function(r){e.locales=r})},methods:{__:function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return localize.apply(void 0,[this.locales].concat(e))}}})}};
