"use strict";function getLocale(e,r){void 0===r&&(r="");var t=e[r];return t||r}function interpolateArray(e,r){void 0===r&&(r=[]);var t=e;return r.forEach(function(e){t=t.replace(/\?/,e)}),t}function interpolateObject(e,r){var t=e;return e.match(/\{[\w]+\}/g).forEach(function(e){var o=e.replace(/\{?\}?/g,""),n=new RegExp(e,"g");t=t.replace(n,r[o])}),t}function pluralization(e,r){var t=e.split("|");return r>1&&t[1]?t[1]:t[0]}function localize(e,r,t,o){try{var n=getLocale(e,r);return o?n=pluralization(n,o):"number"==typeof t&&(n=pluralization(n,t)),Array.isArray(t)?interpolateArray(n,t):"object"==typeof t?interpolateObject(n,t):n}catch(e){return console.error(e),r}}var ajax=function(e){var r=e.path,t=e.method;void 0===t&&(t="GET");var o=new XMLHttpRequest;o.open(t,r,!0);var n=function(){},a={promise:new Promise(function(e,r){o.onload=function(){if(o.status>=200&&o.status<400){var t;try{t=JSON.parse(o.responseText)}catch(r){e(o.responseText)}e(t)}else r(o.responseText)},n=function(){o.abort(),r("Cancelled")},o.onerror=r})};return a.cancel=n,o.send(),a},LocalesLoader=function(e){var r=this,t=e.lang,o=e.SSR,n=e.path,a=e.get,i=e.locales;if(this.locales={},this.observers={},console.log("entro aca"),i)return void(this.locales=i);if(a)return void a().then(function(e){r.locales[t]=e,r.observers[t].map(function(r){return r(e)})}).catch(function(e){console.error(e)});if(o){var c=require(n);return this.locales[t]=c,void this.observers[t].map(function(e){return e(c)})}ajax({path:n}).promise.then(function(e){r.locales[t]=e,r.observers[t].map(function(r){return r(e)})}).catch(function(e){console.error(e)})};LocalesLoader.prototype.subscribe=function(e,r){if(this.locales[e])return void r(this.locales[e]);this.observers[e]=this.observers[e]||[],this.observers[e].push(r)};var index={install:function(e,r){var t=r.lang,o=r.SSR,n=r.path,a=r.get,i=r.locales,c=new LocalesLoader({lang:t,SSR:o,path:n,get:a,locales:i});e.mixin({data:function(){return{lang:t,locales:{}}},created:function(){var e=this;c.subscribe(t,function(r){e.locales=r})},methods:{__:function(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return localize.apply(void 0,[this.locales].concat(e))}}})}};module.exports=index;
